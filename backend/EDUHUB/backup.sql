PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE IF NOT EXISTS "django_migrations" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "app" varchar(255) NOT NULL, "name" varchar(255) NOT NULL, "applied" datetime NOT NULL);
INSERT INTO django_migrations VALUES(1,'contenttypes','0001_initial','2025-07-14 22:20:05.866493');
INSERT INTO django_migrations VALUES(2,'contenttypes','0002_remove_content_type_name','2025-07-14 22:20:05.966189');
INSERT INTO django_migrations VALUES(3,'auth','0001_initial','2025-07-14 22:20:06.239949');
INSERT INTO django_migrations VALUES(4,'auth','0002_alter_permission_name_max_length','2025-07-14 22:20:06.375106');
INSERT INTO django_migrations VALUES(5,'auth','0003_alter_user_email_max_length','2025-07-14 22:20:06.545166');
INSERT INTO django_migrations VALUES(6,'auth','0004_alter_user_username_opts','2025-07-14 22:20:06.662792');
INSERT INTO django_migrations VALUES(7,'auth','0005_alter_user_last_login_null','2025-07-14 22:20:06.761722');
INSERT INTO django_migrations VALUES(8,'auth','0006_require_contenttypes_0002','2025-07-14 22:20:06.864033');
INSERT INTO django_migrations VALUES(9,'auth','0007_alter_validators_add_error_messages','2025-07-14 22:20:06.965262');
INSERT INTO django_migrations VALUES(10,'auth','0008_alter_user_username_max_length','2025-07-14 22:20:07.056205');
INSERT INTO django_migrations VALUES(11,'auth','0009_alter_user_last_name_max_length','2025-07-14 22:20:07.155119');
INSERT INTO django_migrations VALUES(12,'auth','0010_alter_group_name_max_length','2025-07-14 22:20:07.293337');
INSERT INTO django_migrations VALUES(13,'auth','0011_update_proxy_permissions','2025-07-14 22:20:07.488405');
INSERT INTO django_migrations VALUES(14,'auth','0012_alter_user_first_name_max_length','2025-07-14 22:20:07.593265');
INSERT INTO django_migrations VALUES(15,'authentication','0001_initial','2025-07-14 22:20:07.850652');
INSERT INTO django_migrations VALUES(16,'admin','0001_initial','2025-07-14 22:20:08.050095');
INSERT INTO django_migrations VALUES(17,'admin','0002_logentry_remove_auto_add','2025-07-14 22:20:08.169416');
INSERT INTO django_migrations VALUES(18,'admin','0003_logentry_add_action_flag_choices','2025-07-14 22:20:08.319396');
INSERT INTO django_migrations VALUES(19,'universities','0001_initial','2025-07-14 22:20:08.590665');
INSERT INTO django_migrations VALUES(20,'courses','0001_initial','2025-07-14 22:20:09.124353');
INSERT INTO django_migrations VALUES(21,'authentication','0002_initial','2025-07-14 22:20:09.619486');
INSERT INTO django_migrations VALUES(22,'payments','0001_initial','2025-07-14 22:20:10.171066');
INSERT INTO django_migrations VALUES(23,'sessions','0001_initial','2025-07-14 22:20:10.438134');
INSERT INTO django_migrations VALUES(24,'courses','0002_delete_userselectedcourse','2025-07-15 22:27:27.977579');
INSERT INTO django_migrations VALUES(25,'authentication','0003_userselectedcourse','2025-07-15 22:27:28.278124');
INSERT INTO django_migrations VALUES(26,'authentication','0004_alter_userselectedcourse_options_and_more','2025-07-15 22:37:23.694679');
INSERT INTO django_migrations VALUES(27,'authentication','0005_alter_user_phone_number','2025-07-19 23:48:12.325691');
CREATE TABLE IF NOT EXISTS "django_content_type" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "app_label" varchar(100) NOT NULL, "model" varchar(100) NOT NULL);
INSERT INTO django_content_type VALUES(1,'admin','logentry');
INSERT INTO django_content_type VALUES(2,'auth','permission');
INSERT INTO django_content_type VALUES(3,'auth','group');
INSERT INTO django_content_type VALUES(4,'contenttypes','contenttype');
INSERT INTO django_content_type VALUES(5,'sessions','session');
INSERT INTO django_content_type VALUES(6,'authentication','user');
INSERT INTO django_content_type VALUES(7,'authentication','userprofile');
INSERT INTO django_content_type VALUES(8,'authentication','usersession');
INSERT INTO django_content_type VALUES(9,'authentication','useractivity');
INSERT INTO django_content_type VALUES(10,'authentication','usersubject');
INSERT INTO django_content_type VALUES(11,'authentication','userselectedcourse');
INSERT INTO django_content_type VALUES(12,'courses','subject');
INSERT INTO django_content_type VALUES(13,'courses','course');
INSERT INTO django_content_type VALUES(14,'courses','coursesubjectrequirement');
INSERT INTO django_content_type VALUES(15,'courses','coursereview');
INSERT INTO django_content_type VALUES(16,'courses','courseapplication');
INSERT INTO django_content_type VALUES(17,'payments','subscriptionplan');
INSERT INTO django_content_type VALUES(18,'payments','subscription');
INSERT INTO django_content_type VALUES(19,'payments','usersubscription');
INSERT INTO django_content_type VALUES(20,'payments','payment');
INSERT INTO django_content_type VALUES(21,'payments','paymentcallback');
INSERT INTO django_content_type VALUES(22,'payments','paymentwebhook');
INSERT INTO django_content_type VALUES(23,'universities','university');
INSERT INTO django_content_type VALUES(24,'universities','faculty');
INSERT INTO django_content_type VALUES(25,'universities','department');
INSERT INTO django_content_type VALUES(26,'universities','universityrequirement');
CREATE TABLE IF NOT EXISTS "auth_group_permissions" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "group_id" integer NOT NULL REFERENCES "auth_group" ("id") DEFERRABLE INITIALLY DEFERRED, "permission_id" integer NOT NULL REFERENCES "auth_permission" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "auth_permission" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "content_type_id" integer NOT NULL REFERENCES "django_content_type" ("id") DEFERRABLE INITIALLY DEFERRED, "codename" varchar(100) NOT NULL, "name" varchar(255) NOT NULL);
INSERT INTO auth_permission VALUES(1,1,'add_logentry','Can add log entry');
INSERT INTO auth_permission VALUES(2,1,'change_logentry','Can change log entry');
INSERT INTO auth_permission VALUES(3,1,'delete_logentry','Can delete log entry');
INSERT INTO auth_permission VALUES(4,1,'view_logentry','Can view log entry');
INSERT INTO auth_permission VALUES(5,2,'add_permission','Can add permission');
INSERT INTO auth_permission VALUES(6,2,'change_permission','Can change permission');
INSERT INTO auth_permission VALUES(7,2,'delete_permission','Can delete permission');
INSERT INTO auth_permission VALUES(8,2,'view_permission','Can view permission');
INSERT INTO auth_permission VALUES(9,3,'add_group','Can add group');
INSERT INTO auth_permission VALUES(10,3,'change_group','Can change group');
INSERT INTO auth_permission VALUES(11,3,'delete_group','Can delete group');
INSERT INTO auth_permission VALUES(12,3,'view_group','Can view group');
INSERT INTO auth_permission VALUES(13,4,'add_contenttype','Can add content type');
INSERT INTO auth_permission VALUES(14,4,'change_contenttype','Can change content type');
INSERT INTO auth_permission VALUES(15,4,'delete_contenttype','Can delete content type');
INSERT INTO auth_permission VALUES(16,4,'view_contenttype','Can view content type');
INSERT INTO auth_permission VALUES(17,5,'add_session','Can add session');
INSERT INTO auth_permission VALUES(18,5,'change_session','Can change session');
INSERT INTO auth_permission VALUES(19,5,'delete_session','Can delete session');
INSERT INTO auth_permission VALUES(20,5,'view_session','Can view session');
INSERT INTO auth_permission VALUES(21,6,'add_user','Can add User');
INSERT INTO auth_permission VALUES(22,6,'change_user','Can change User');
INSERT INTO auth_permission VALUES(23,6,'delete_user','Can delete User');
INSERT INTO auth_permission VALUES(24,6,'view_user','Can view User');
INSERT INTO auth_permission VALUES(25,7,'add_userprofile','Can add User Profile');
INSERT INTO auth_permission VALUES(26,7,'change_userprofile','Can change User Profile');
INSERT INTO auth_permission VALUES(27,7,'delete_userprofile','Can delete User Profile');
INSERT INTO auth_permission VALUES(28,7,'view_userprofile','Can view User Profile');
INSERT INTO auth_permission VALUES(29,8,'add_usersession','Can add User Session');
INSERT INTO auth_permission VALUES(30,8,'change_usersession','Can change User Session');
INSERT INTO auth_permission VALUES(31,8,'delete_usersession','Can delete User Session');
INSERT INTO auth_permission VALUES(32,8,'view_usersession','Can view User Session');
INSERT INTO auth_permission VALUES(33,9,'add_useractivity','Can add User Activity');
INSERT INTO auth_permission VALUES(34,9,'change_useractivity','Can change User Activity');
INSERT INTO auth_permission VALUES(35,9,'delete_useractivity','Can delete User Activity');
INSERT INTO auth_permission VALUES(36,9,'view_useractivity','Can view User Activity');
INSERT INTO auth_permission VALUES(37,10,'add_usersubject','Can add User Subject');
INSERT INTO auth_permission VALUES(38,10,'change_usersubject','Can change User Subject');
INSERT INTO auth_permission VALUES(39,10,'delete_usersubject','Can delete User Subject');
INSERT INTO auth_permission VALUES(40,10,'view_usersubject','Can view User Subject');
INSERT INTO auth_permission VALUES(41,11,'add_userselectedcourse','Can add user selected course');
INSERT INTO auth_permission VALUES(42,11,'change_userselectedcourse','Can change user selected course');
INSERT INTO auth_permission VALUES(43,11,'delete_userselectedcourse','Can delete user selected course');
INSERT INTO auth_permission VALUES(44,11,'view_userselectedcourse','Can view user selected course');
INSERT INTO auth_permission VALUES(45,12,'add_subject','Can add Subject');
INSERT INTO auth_permission VALUES(46,12,'change_subject','Can change Subject');
INSERT INTO auth_permission VALUES(47,12,'delete_subject','Can delete Subject');
INSERT INTO auth_permission VALUES(48,12,'view_subject','Can view Subject');
INSERT INTO auth_permission VALUES(49,13,'add_course','Can add course');
INSERT INTO auth_permission VALUES(50,13,'change_course','Can change course');
INSERT INTO auth_permission VALUES(51,13,'delete_course','Can delete course');
INSERT INTO auth_permission VALUES(52,13,'view_course','Can view course');
INSERT INTO auth_permission VALUES(53,14,'add_coursesubjectrequirement','Can add course subject requirement');
INSERT INTO auth_permission VALUES(54,14,'change_coursesubjectrequirement','Can change course subject requirement');
INSERT INTO auth_permission VALUES(55,14,'delete_coursesubjectrequirement','Can delete course subject requirement');
INSERT INTO auth_permission VALUES(56,14,'view_coursesubjectrequirement','Can view course subject requirement');
INSERT INTO auth_permission VALUES(57,15,'add_coursereview','Can add course review');
INSERT INTO auth_permission VALUES(58,15,'change_coursereview','Can change course review');
INSERT INTO auth_permission VALUES(59,15,'delete_coursereview','Can delete course review');
INSERT INTO auth_permission VALUES(60,15,'view_coursereview','Can view course review');
INSERT INTO auth_permission VALUES(61,16,'add_courseapplication','Can add course application');
INSERT INTO auth_permission VALUES(62,16,'change_courseapplication','Can change course application');
INSERT INTO auth_permission VALUES(63,16,'delete_courseapplication','Can delete course application');
INSERT INTO auth_permission VALUES(64,16,'view_courseapplication','Can view course application');
INSERT INTO auth_permission VALUES(65,17,'add_subscriptionplan','Can add subscription plan');
INSERT INTO auth_permission VALUES(66,17,'change_subscriptionplan','Can change subscription plan');
INSERT INTO auth_permission VALUES(67,17,'delete_subscriptionplan','Can delete subscription plan');
INSERT INTO auth_permission VALUES(68,17,'view_subscriptionplan','Can view subscription plan');
INSERT INTO auth_permission VALUES(69,18,'add_subscription','Can add subscription');
INSERT INTO auth_permission VALUES(70,18,'change_subscription','Can change subscription');
INSERT INTO auth_permission VALUES(71,18,'delete_subscription','Can delete subscription');
INSERT INTO auth_permission VALUES(72,18,'view_subscription','Can view subscription');
INSERT INTO auth_permission VALUES(73,19,'add_usersubscription','Can add user subscription');
INSERT INTO auth_permission VALUES(74,19,'change_usersubscription','Can change user subscription');
INSERT INTO auth_permission VALUES(75,19,'delete_usersubscription','Can delete user subscription');
INSERT INTO auth_permission VALUES(76,19,'view_usersubscription','Can view user subscription');
INSERT INTO auth_permission VALUES(77,20,'add_payment','Can add payment');
INSERT INTO auth_permission VALUES(78,20,'change_payment','Can change payment');
INSERT INTO auth_permission VALUES(79,20,'delete_payment','Can delete payment');
INSERT INTO auth_permission VALUES(80,20,'view_payment','Can view payment');
INSERT INTO auth_permission VALUES(81,21,'add_paymentcallback','Can add payment callback');
INSERT INTO auth_permission VALUES(82,21,'change_paymentcallback','Can change payment callback');
INSERT INTO auth_permission VALUES(83,21,'delete_paymentcallback','Can delete payment callback');
INSERT INTO auth_permission VALUES(84,21,'view_paymentcallback','Can view payment callback');
INSERT INTO auth_permission VALUES(85,22,'add_paymentwebhook','Can add payment webhook');
INSERT INTO auth_permission VALUES(86,22,'change_paymentwebhook','Can change payment webhook');
INSERT INTO auth_permission VALUES(87,22,'delete_paymentwebhook','Can delete payment webhook');
INSERT INTO auth_permission VALUES(88,22,'view_paymentwebhook','Can view payment webhook');
INSERT INTO auth_permission VALUES(89,23,'add_university','Can add University');
INSERT INTO auth_permission VALUES(90,23,'change_university','Can change University');
INSERT INTO auth_permission VALUES(91,23,'delete_university','Can delete University');
INSERT INTO auth_permission VALUES(92,23,'view_university','Can view University');
INSERT INTO auth_permission VALUES(93,24,'add_faculty','Can add Faculty');
INSERT INTO auth_permission VALUES(94,24,'change_faculty','Can change Faculty');
INSERT INTO auth_permission VALUES(95,24,'delete_faculty','Can delete Faculty');
INSERT INTO auth_permission VALUES(96,24,'view_faculty','Can view Faculty');
INSERT INTO auth_permission VALUES(97,25,'add_department','Can add Department');
INSERT INTO auth_permission VALUES(98,25,'change_department','Can change Department');
INSERT INTO auth_permission VALUES(99,25,'delete_department','Can delete Department');
INSERT INTO auth_permission VALUES(100,25,'view_department','Can view Department');
INSERT INTO auth_permission VALUES(101,26,'add_universityrequirement','Can add University Requirement');
INSERT INTO auth_permission VALUES(102,26,'change_universityrequirement','Can change University Requirement');
INSERT INTO auth_permission VALUES(103,26,'delete_universityrequirement','Can delete University Requirement');
INSERT INTO auth_permission VALUES(104,26,'view_universityrequirement','Can view University Requirement');
CREATE TABLE IF NOT EXISTS "auth_group" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "name" varchar(150) NOT NULL UNIQUE);
CREATE TABLE IF NOT EXISTS "auth_user_groups" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "user_id" bigint NOT NULL REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED, "group_id" integer NOT NULL REFERENCES "auth_group" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "auth_user_user_permissions" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "user_id" bigint NOT NULL REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED, "permission_id" integer NOT NULL REFERENCES "auth_permission" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "user_activity" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "action" varchar(50) NOT NULL, "timestamp" datetime NOT NULL, "ip_address" char(39) NOT NULL, "details" text NOT NULL CHECK ((JSON_VALID("details") OR "details" IS NULL)), "success" bool NOT NULL, "error_message" text NOT NULL, "request_id" varchar(100) NOT NULL, "user_id" bigint NOT NULL REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "user_profile" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "date_of_birth" date NULL, "gender" varchar(1) NOT NULL, "county" varchar(20) NOT NULL, "preferred_study_mode" varchar(20) NOT NULL, "preferred_location" varchar(100) NOT NULL, "career_interests" text NOT NULL, "avatar" varchar(100) NULL, "bio" text NOT NULL, "email_notifications" bool NOT NULL, "sms_notifications" bool NOT NULL, "marketing_emails" bool NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "user_id" bigint NOT NULL UNIQUE REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "user_session" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "session_key" varchar(255) NOT NULL, "ip_address" char(39) NOT NULL, "user_agent" text NOT NULL, "device_type" varchar(20) NOT NULL, "browser" varchar(50) NOT NULL, "os" varchar(50) NOT NULL, "country" varchar(50) NOT NULL, "city" varchar(100) NOT NULL, "is_active" bool NOT NULL, "created_at" datetime NOT NULL, "last_activity" datetime NOT NULL, "logout_time" datetime NULL, "user_id" bigint NOT NULL REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "django_admin_log" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "object_id" text NULL, "object_repr" varchar(200) NOT NULL, "action_flag" smallint unsigned NOT NULL CHECK ("action_flag" >= 0), "change_message" text NOT NULL, "content_type_id" integer NULL REFERENCES "django_content_type" ("id") DEFERRABLE INITIALLY DEFERRED, "user_id" bigint NOT NULL REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED, "action_time" datetime NOT NULL);
CREATE TABLE IF NOT EXISTS "universities_university" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "name" varchar(255) NOT NULL UNIQUE, "slug" varchar(255) NOT NULL UNIQUE, "code" varchar(20) NOT NULL UNIQUE, "description" text NOT NULL, "website" varchar(200) NOT NULL, "campus" varchar NOT NULL, "accreditation" varchar(200) NOT NULL, "logo" varchar(100) NULL, "address" text NOT NULL, "city" varchar(100) NOT NULL, "type" varchar(50) NOT NULL, "is_active" bool NOT NULL, "ranking" integer unsigned NULL CHECK ("ranking" >= 0), "established_year" integer unsigned NULL CHECK ("established_year" >= 0));
CREATE TABLE IF NOT EXISTS "universities_faculty" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "name" varchar(255) NOT NULL, "slug" varchar(255) NOT NULL, "description" text NOT NULL, "is_active" bool NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "university_id" bigint NOT NULL REFERENCES "universities_university" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "universities_universityrequirement" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "title" varchar(255) NOT NULL, "description" text NOT NULL, "min_grade" varchar(5) NOT NULL, "is_active" bool NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "university_id" bigint NOT NULL REFERENCES "universities_university" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "universities_department" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "name" varchar(255) NOT NULL, "slug" varchar(255) NOT NULL, "description" text NOT NULL, "is_active" bool NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "faculty_id" bigint NOT NULL REFERENCES "universities_faculty" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "courses_subject" ("id" char(32) NOT NULL PRIMARY KEY, "name" varchar(100) NOT NULL UNIQUE, "code" varchar(10) NOT NULL UNIQUE, "description" text NOT NULL, "is_core" bool NOT NULL, "is_active" bool NOT NULL, "created_at" datetime NOT NULL);
CREATE TABLE IF NOT EXISTS "courses_coursesubjectrequirement" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "minimum_grade" varchar(5) NOT NULL, "is_mandatory" bool NOT NULL, "course_id" char(32) NOT NULL REFERENCES "courses_course" ("id") DEFERRABLE INITIALLY DEFERRED, "subject_id" char(32) NOT NULL REFERENCES "courses_subject" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "courses_coursesubjectrequirement_alternative_subjects" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "coursesubjectrequirement_id" bigint NOT NULL REFERENCES "courses_coursesubjectrequirement" ("id") DEFERRABLE INITIALLY DEFERRED, "subject_id" char(32) NOT NULL REFERENCES "courses_subject" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "courses_course" ("id" char(32) NOT NULL PRIMARY KEY, "name" varchar(200) NOT NULL, "code" varchar(20) NOT NULL, "description" text NOT NULL, "duration_years" integer unsigned NOT NULL CHECK ("duration_years" >= 0), "minimum_grade" varchar(5) NOT NULL, "category" varchar(100) NOT NULL, "tuition_fee_per_year" decimal NOT NULL, "application_fee" decimal NOT NULL, "application_deadline" date NULL, "intake_months" text NOT NULL CHECK ((JSON_VALID("intake_months") OR "intake_months" IS NULL)), "career_prospects" text NOT NULL, "is_active" bool NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "university_id" bigint NOT NULL REFERENCES "universities_university" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "courses_courseapplication" ("id" char(32) NOT NULL PRIMARY KEY, "status" varchar(20) NOT NULL, "application_number" varchar(50) NOT NULL UNIQUE, "submitted_at" datetime NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "course_id" char(32) NOT NULL REFERENCES "courses_course" ("id") DEFERRABLE INITIALLY DEFERRED, "user_id" bigint NOT NULL REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "courses_coursereview" ("id" char(32) NOT NULL PRIMARY KEY, "rating" integer unsigned NOT NULL CHECK ("rating" >= 0), "title" varchar(200) NOT NULL, "content" text NOT NULL, "is_approved" bool NOT NULL, "is_anonymous" bool NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "course_id" char(32) NOT NULL REFERENCES "courses_course" ("id") DEFERRABLE INITIALLY DEFERRED, "user_id" bigint NOT NULL REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "user_subject" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "grade" varchar(2) NOT NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "subject_id" char(32) NOT NULL REFERENCES "courses_subject" ("id") DEFERRABLE INITIALLY DEFERRED, "user_id" bigint NOT NULL REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "payments_subscriptionplan" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "name" varchar(100) NOT NULL, "price" decimal NOT NULL, "duration_hours" integer unsigned NOT NULL CHECK ("duration_hours" >= 0), "renewal_price" decimal NOT NULL, "renewal_grace_period_hours" integer unsigned NOT NULL CHECK ("renewal_grace_period_hours" >= 0));
CREATE TABLE IF NOT EXISTS "payments_payment" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "amount" decimal NOT NULL, "payment_method" varchar(50) NOT NULL, "status" varchar(50) NOT NULL, "transaction_id" varchar(100) NULL, "phone_number" varchar(20) NOT NULL, "failure_reason" text NULL, "reference" varchar(100) NOT NULL UNIQUE, "description" text NULL, "subscription_type" varchar(100) NULL, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL, "mpesa_receipt_number" varchar(100) NULL, "merchant_request_id" varchar(100) NULL, "checkout_request_id" varchar(100) NULL, "callback_metadata" text NULL CHECK ((JSON_VALID("callback_metadata") OR "callback_metadata" IS NULL)), "user_id" bigint NOT NULL REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED, "subscription_id" bigint NULL REFERENCES "payments_subscription" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "payments_paymentcallback" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "data" text NOT NULL CHECK ((JSON_VALID("data") OR "data" IS NULL)), "received_at" datetime NOT NULL, "payment_id" bigint NOT NULL REFERENCES "payments_payment" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "payments_paymentwebhook" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "raw_data" text NOT NULL CHECK ((JSON_VALID("raw_data") OR "raw_data" IS NULL)), "received_at" datetime NOT NULL, "payment_id" bigint NULL REFERENCES "payments_payment" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "payments_subscription" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "start_date" datetime NOT NULL, "end_date" datetime NOT NULL, "active" bool NOT NULL, "last_payment_at" datetime NULL, "is_renewal_eligible" bool NOT NULL, "user_id" bigint NOT NULL REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED, "plan_id" bigint NOT NULL REFERENCES "payments_subscriptionplan" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "payments_usersubscription" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "renewal_attempted" bool NOT NULL, "renewal_successful" bool NOT NULL, "current_subscription_id" bigint NULL REFERENCES "payments_subscription" ("id") DEFERRABLE INITIALLY DEFERRED, "user_id" bigint NOT NULL UNIQUE REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "django_session" ("session_key" varchar(40) NOT NULL PRIMARY KEY, "session_data" text NOT NULL, "expire_date" datetime NOT NULL);
CREATE TABLE IF NOT EXISTS "authentication_userselectedcourse" ("id" char(32) NOT NULL PRIMARY KEY, "is_applied" bool NOT NULL, "application_date" datetime NULL, "created_at" datetime NOT NULL, "course_id" char(32) NOT NULL REFERENCES "courses_course" ("id") DEFERRABLE INITIALLY DEFERRED, "user_id" bigint NOT NULL REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED);
CREATE TABLE IF NOT EXISTS "auth_user" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "password" varchar(128) NOT NULL, "is_superuser" bool NOT NULL, "email" varchar(254) NOT NULL UNIQUE, "first_name" varchar(30) NOT NULL, "last_name" varchar(30) NOT NULL, "is_active" bool NOT NULL, "is_staff" bool NOT NULL, "is_verified" bool NOT NULL, "is_premium" bool NOT NULL, "date_joined" datetime NOT NULL, "last_login" datetime NULL, "phone_number" varchar(15) NULL UNIQUE);
DELETE FROM sqlite_sequence;
INSERT INTO sqlite_sequence VALUES('django_migrations',27);
INSERT INTO sqlite_sequence VALUES('django_content_type',26);
INSERT INTO sqlite_sequence VALUES('auth_permission',104);
INSERT INTO sqlite_sequence VALUES('auth_group',0);
INSERT INTO sqlite_sequence VALUES('django_admin_log',0);
INSERT INTO sqlite_sequence VALUES('user_subject',0);
INSERT INTO sqlite_sequence VALUES('universities_university',0);
INSERT INTO sqlite_sequence VALUES('universities_faculty',0);
INSERT INTO sqlite_sequence VALUES('universities_universityrequirement',0);
INSERT INTO sqlite_sequence VALUES('payments_subscriptionplan',0);
INSERT INTO sqlite_sequence VALUES('auth_user',0);
CREATE UNIQUE INDEX "django_content_type_app_label_model_76bd3d3b_uniq" ON "django_content_type" ("app_label", "model");
CREATE UNIQUE INDEX "auth_group_permissions_group_id_permission_id_0cd325b0_uniq" ON "auth_group_permissions" ("group_id", "permission_id");
CREATE INDEX "auth_group_permissions_group_id_b120cbf9" ON "auth_group_permissions" ("group_id");
CREATE INDEX "auth_group_permissions_permission_id_84c5c92e" ON "auth_group_permissions" ("permission_id");
CREATE UNIQUE INDEX "auth_permission_content_type_id_codename_01ab375a_uniq" ON "auth_permission" ("content_type_id", "codename");
CREATE INDEX "auth_permission_content_type_id_2f476e4b" ON "auth_permission" ("content_type_id");
CREATE UNIQUE INDEX "auth_user_groups_user_id_group_id_94350c0c_uniq" ON "auth_user_groups" ("user_id", "group_id");
CREATE INDEX "auth_user_groups_user_id_6a12ed8b" ON "auth_user_groups" ("user_id");
CREATE INDEX "auth_user_groups_group_id_97559544" ON "auth_user_groups" ("group_id");
CREATE UNIQUE INDEX "auth_user_user_permissions_user_id_permission_id_14a6b632_uniq" ON "auth_user_user_permissions" ("user_id", "permission_id");
CREATE INDEX "auth_user_user_permissions_user_id_a95ead1b" ON "auth_user_user_permissions" ("user_id");
CREATE INDEX "auth_user_user_permissions_permission_id_1fbb5f2c" ON "auth_user_user_permissions" ("permission_id");
CREATE INDEX "user_activity_action_87f2c2c8" ON "user_activity" ("action");
CREATE INDEX "user_activity_timestamp_b80185f7" ON "user_activity" ("timestamp");
CREATE INDEX "user_activity_user_id_9d5b7120" ON "user_activity" ("user_id");
CREATE INDEX "user_session_session_key_05f075b5" ON "user_session" ("session_key");
CREATE INDEX "user_session_user_id_babcef0a" ON "user_session" ("user_id");
CREATE INDEX "django_admin_log_content_type_id_c4bce8eb" ON "django_admin_log" ("content_type_id");
CREATE INDEX "django_admin_log_user_id_c564eba6" ON "django_admin_log" ("user_id");
CREATE INDEX "universitie_name_504812_idx" ON "universities_university" ("name");
CREATE INDEX "universitie_code_4bbf30_idx" ON "universities_university" ("code");
CREATE INDEX "universitie_city_aff264_idx" ON "universities_university" ("city");
CREATE INDEX "universitie_is_acti_d3dcd7_idx" ON "universities_university" ("is_active");
CREATE UNIQUE INDEX "universities_faculty_university_id_name_86e0bba4_uniq" ON "universities_faculty" ("university_id", "name");
CREATE INDEX "universities_faculty_slug_e3f22eaf" ON "universities_faculty" ("slug");
CREATE INDEX "universities_faculty_university_id_f110037c" ON "universities_faculty" ("university_id");
CREATE INDEX "universities_universityrequirement_university_id_dad5c45c" ON "universities_universityrequirement" ("university_id");
CREATE UNIQUE INDEX "universities_department_faculty_id_name_c387139d_uniq" ON "universities_department" ("faculty_id", "name");
CREATE INDEX "universities_department_slug_09dbaa55" ON "universities_department" ("slug");
CREATE INDEX "universities_department_faculty_id_59c39128" ON "universities_department" ("faculty_id");
CREATE INDEX "courses_sub_is_core_c20d08_idx" ON "courses_subject" ("is_core");
CREATE INDEX "courses_sub_is_acti_7c6ad7_idx" ON "courses_subject" ("is_active");
CREATE UNIQUE INDEX "courses_coursesubjectrequirement_course_id_subject_id_69d0208e_uniq" ON "courses_coursesubjectrequirement" ("course_id", "subject_id");
CREATE INDEX "courses_coursesubjectrequirement_course_id_dc2dcfd2" ON "courses_coursesubjectrequirement" ("course_id");
CREATE INDEX "courses_coursesubjectrequirement_subject_id_2a8dcb61" ON "courses_coursesubjectrequirement" ("subject_id");
CREATE UNIQUE INDEX "courses_coursesubjectrequirement_alternative_subjects_coursesubjectrequirement_id_subject_id_ab76cff0_uniq" ON "courses_coursesubjectrequirement_alternative_subjects" ("coursesubjectrequirement_id", "subject_id");
CREATE INDEX "courses_coursesubjectrequirement_alternative_subjects_coursesubjectrequirement_id_fe9d10b2" ON "courses_coursesubjectrequirement_alternative_subjects" ("coursesubjectrequirement_id");
CREATE INDEX "courses_coursesubjectrequirement_alternative_subjects_subject_id_b768523f" ON "courses_coursesubjectrequirement_alternative_subjects" ("subject_id");
CREATE INDEX "courses_course_university_id_65d105dd" ON "courses_course" ("university_id");
CREATE INDEX "courses_cou_categor_fec4a4_idx" ON "courses_course" ("category");
CREATE INDEX "courses_cou_minimum_b5d3f6_idx" ON "courses_course" ("minimum_grade");
CREATE INDEX "courses_cou_tuition_72de5a_idx" ON "courses_course" ("tuition_fee_per_year");
CREATE INDEX "courses_cou_is_acti_3c7e41_idx" ON "courses_course" ("is_active");
CREATE INDEX "courses_cou_univers_5f4e01_idx" ON "courses_course" ("university_id");
CREATE UNIQUE INDEX "courses_course_code_university_id_3eedeea1_uniq" ON "courses_course" ("code", "university_id");
CREATE UNIQUE INDEX "courses_courseapplication_user_id_course_id_edd98050_uniq" ON "courses_courseapplication" ("user_id", "course_id");
CREATE INDEX "courses_courseapplication_course_id_e24ca1e0" ON "courses_courseapplication" ("course_id");
CREATE INDEX "courses_courseapplication_user_id_bfcf8a85" ON "courses_courseapplication" ("user_id");
CREATE UNIQUE INDEX "courses_coursereview_course_id_user_id_a4c0e90c_uniq" ON "courses_coursereview" ("course_id", "user_id");
CREATE INDEX "courses_coursereview_course_id_15681ba3" ON "courses_coursereview" ("course_id");
CREATE INDEX "courses_coursereview_user_id_7838c5d6" ON "courses_coursereview" ("user_id");
CREATE INDEX "user_subject_subject_id_19ef00b6" ON "user_subject" ("subject_id");
CREATE INDEX "user_subject_user_id_a804a3c1" ON "user_subject" ("user_id");
CREATE INDEX "user_activi_user_id_e71375_idx" ON "user_activity" ("user_id", "action");
CREATE INDEX "user_activi_timesta_85b358_idx" ON "user_activity" ("timestamp");
CREATE INDEX "user_activi_ip_addr_df0e04_idx" ON "user_activity" ("ip_address");
CREATE INDEX "user_activi_success_ca8f9e_idx" ON "user_activity" ("success");
CREATE INDEX "user_sessio_user_id_4f7411_idx" ON "user_session" ("user_id", "is_active");
CREATE INDEX "user_sessio_session_ab559f_idx" ON "user_session" ("session_key");
CREATE INDEX "user_sessio_ip_addr_b87514_idx" ON "user_session" ("ip_address");
CREATE INDEX "user_sessio_created_4bbdd5_idx" ON "user_session" ("created_at");
CREATE INDEX "user_subjec_user_id_a17fdd_idx" ON "user_subject" ("user_id");
CREATE INDEX "user_subjec_subject_89940d_idx" ON "user_subject" ("subject_id");
CREATE INDEX "user_subjec_grade_337940_idx" ON "user_subject" ("grade");
CREATE UNIQUE INDEX "user_subject_user_id_subject_id_cc9643ff_uniq" ON "user_subject" ("user_id", "subject_id");
CREATE INDEX "payments_payment_user_id_f9db060a" ON "payments_payment" ("user_id");
CREATE INDEX "payments_paymentcallback_payment_id_97e36d03" ON "payments_paymentcallback" ("payment_id");
CREATE INDEX "payments_paymentwebhook_payment_id_9117f629" ON "payments_paymentwebhook" ("payment_id");
CREATE INDEX "payments_subscription_user_id_1b2156fc" ON "payments_subscription" ("user_id");
CREATE INDEX "payments_subscription_plan_id_973ba84d" ON "payments_subscription" ("plan_id");
CREATE INDEX "payments_payment_subscription_id_4cc8f173" ON "payments_payment" ("subscription_id");
CREATE INDEX "payments_usersubscription_current_subscription_id_26c0cb98" ON "payments_usersubscription" ("current_subscription_id");
CREATE INDEX "django_session_expire_date_a5c62663" ON "django_session" ("expire_date");
CREATE UNIQUE INDEX "authentication_userselectedcourse_user_id_course_id_145f2cad_uniq" ON "authentication_userselectedcourse" ("user_id", "course_id");
CREATE INDEX "authentication_userselectedcourse_course_id_067f52e2" ON "authentication_userselectedcourse" ("course_id");
CREATE INDEX "authentication_userselectedcourse_user_id_d6b947a9" ON "authentication_userselectedcourse" ("user_id");
CREATE INDEX "auth_user_email_ece7f7_idx" ON "auth_user" ("email");
CREATE INDEX "auth_user_is_acti_29b1d2_idx" ON "auth_user" ("is_active", "is_verified");
CREATE INDEX "auth_user_date_jo_f1a394_idx" ON "auth_user" ("date_joined");
COMMIT;
